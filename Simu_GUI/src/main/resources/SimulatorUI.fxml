<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.chart.*?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            stylesheets="@styles.css"
            prefWidth="1200" prefHeight="760"
            styleClass="root-pane">

    <!-- TOP HEADER -->
    <top>
        <HBox spacing="12" alignment="CENTER_LEFT" styleClass="top-bar">
            <padding>
                <Insets top="12" right="20" bottom="12" left="20"/>
            </padding>

            <Label text="Cafeteria Simulator" styleClass="app-title"/>

            <Pane HBox.hgrow="ALWAYS"/>

            <Button text="Save Preset" styleClass="ghost-button"/>
            <Button text="Run Simulation" fx:id="runBtn" styleClass="primary-button"/>
        </HBox>
    </top>

    <!-- LEFT SIDEBAR -->
    <left>
        <ScrollPane fitToWidth="true" prefWidth="320" styleClass="sidebar-scroll">
            <content>
                <VBox spacing="14" styleClass="sidebar">
                    <padding>
                        <Insets top="16" right="16" bottom="16" left="16"/>
                    </padding>

                    <!-- Section Header -->
                    <Label text="Simulation Settings" styleClass="section-title"/>

                    <!-- Opening Hours -->
                    <TitledPane text="Opening Hours" expanded="true" styleClass="panel-card">
                        <content>
                            <VBox spacing="8">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>

                                <HBox spacing="8" alignment="CENTER_LEFT">
                                    <Label text="Hours:"/>
                                    <TextField fx:id="openingHoursField" prefWidth="100" promptText="3"/>
                                </HBox>

                                <Label text="Arrival Rate (students / hr)" />

                                <HBox spacing="8" alignment="CENTER_LEFT">
                                    <Slider fx:id="arrivalSlider" min="0" max="500" value="120" prefWidth="200"/>
                                    <Label fx:id="arrivalValue" text="120"/>
                                </HBox>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- Meal Station Timings -->
                    <TitledPane text="Meal Station Timings" expanded="false" styleClass="panel-card">
                        <content>
                            <VBox spacing="8">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>

                                <HBox spacing="8">
                                    <Label text="Grill (s):" prefWidth="100"/>
                                    <TextField fx:id="grillTime" prefWidth="80" promptText="45"/>
                                </HBox>

                                <HBox spacing="8">
                                    <Label text="Vegan (s):" prefWidth="100"/>
                                    <TextField fx:id="veganTime" prefWidth="80" promptText="40"/>
                                </HBox>

                                <HBox spacing="8">
                                    <Label text="Normal (s):" prefWidth="100"/>
                                    <TextField fx:id="normalTime" prefWidth="80" promptText="30"/>
                                </HBox>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- Payment -->
                    <TitledPane text="Payment" expanded="false" styleClass="panel-card">
                        <content>
                            <VBox spacing="8">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>

                                <HBox spacing="8">
                                    <Label text="Cashier (s):" prefWidth="120"/>
                                    <TextField fx:id="cashierTime" prefWidth="80" promptText="20"/>
                                </HBox>

                                <HBox spacing="8">
                                    <Label text="Self-service (s):" prefWidth="120"/>
                                    <TextField fx:id="kioskTime" prefWidth="80" promptText="12"/>
                                </HBox>

                                <CheckBox fx:id="enableSelfService" text="Enable Self-service" selected="true"/>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- Coffee -->
                    <TitledPane text="Coffee" expanded="false" styleClass="panel-card">
                        <content>
                            <VBox spacing="8">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>

                                <HBox spacing="8">
                                    <Label text="Pickup (s):" prefWidth="100"/>
                                    <TextField fx:id="coffeeTime" prefWidth="80" promptText="10"/>
                                </HBox>

                                <CheckBox fx:id="coffeeOptional" text="Enable Coffee Station" selected="true"/>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- Advanced -->
                    <TitledPane text="Advanced" expanded="false" styleClass="panel-card">
                        <content>
                            <VBox spacing="8">
                                <padding>
                                    <Insets top="10" right="10" bottom="10" left="10"/>
                                </padding>

                                <Label text="Queue Capacity"/>
                                <ChoiceBox fx:id="queueCapacity" prefWidth="150">
                                    <items>
                                        <FXCollections fx:factory="observableArrayList">
                                            <String fx:value="Unlimited"/>
                                            <String fx:value="50"/>
                                            <String fx:value="100"/>
                                            <String fx:value="200"/>
                                        </FXCollections>
                                    </items>
                                </ChoiceBox>

                                <HBox spacing="8" alignment="CENTER_LEFT">
                                    <Label text="Service Variability"/>
                                    <ToggleButton fx:id="variabilityToggle" text="On/Off"/>
                                </HBox>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- Bottom Buttons -->
                    <HBox spacing="8" alignment="CENTER">
                        <Button text="Run" fx:id="runBtn2" styleClass="primary-button" prefWidth="120"/>
                        <Button text="Reset" fx:id="resetBtn" styleClass="secondary-button" prefWidth="120"/>
                    </HBox>
                </VBox>
            </content>
        </ScrollPane>
    </left>

    <!-- CENTER: Simulation Canvas -->
    <center>
        <VBox spacing="10">
            <padding>
                <Insets top="12" right="12" bottom="12" left="12"/>
            </padding>

            <Label text="Simulation Canvas" styleClass="canvas-title"/>

            <Pane fx:id="simulationCanvas" prefWidth="600" prefHeight="520" styleClass="canvas"/>

            <HBox spacing="12" alignment="CENTER">
                <Button text="Pause" fx:id="pauseBtn" styleClass="secondary-button"/>
                <Button text="Resume" fx:id="resumeBtn" styleClass="secondary-button"/>
                <Button text="Export Report" fx:id="exportBtn" styleClass="ghost-button"/>
            </HBox>
        </VBox>
    </center>

    <!-- RIGHT: Metrics -->
    <right>
        <VBox spacing="12" prefWidth="320" styleClass="right-panel">
            <padding>
                <Insets top="14" right="14" bottom="14" left="14"/>
            </padding>

            <Label text="Analytics" styleClass="section-title"/>

            <HBox spacing="10">
                <VBox spacing="8" styleClass="metric-card" prefWidth="140">
                    <Label text="Throughput" styleClass="metric-title"/>
                    <Label fx:id="throughputLabel" text="0 students/hr" styleClass="metric-value"/>
                </VBox>

                <VBox spacing="8" styleClass="metric-card" prefWidth="140">
                    <Label text="Avg Wait" styleClass="metric-title"/>
                    <Label fx:id="avgWaitLabel" text="0 s" styleClass="metric-value"/>
                </VBox>
            </HBox>

            <HBox spacing="10">
                <VBox spacing="8" styleClass="metric-card" prefWidth="140">
                    <Label text="Peak Queue" styleClass="metric-title"/>
                    <Label fx:id="peakQueueLabel" text="0" styleClass="metric-value"/>
                </VBox>

                <VBox spacing="8" styleClass="metric-card" prefWidth="140">
                    <Label text="Sim Time" styleClass="metric-title"/>
                    <Label fx:id="simTimeLabel" text="00:00" styleClass="metric-value"/>
                </VBox>
            </HBox>

            <Label text="Queue Length Over Time" styleClass="small-heading"/>
            <LineChart fx:id="queueChart" prefHeight="160" prefWidth="280">
                <xAxis>
                    <NumberAxis/>
                </xAxis>
                <yAxis>
                    <NumberAxis/>
                </yAxis>
            </LineChart>

            <Label text="Utilization by Station" styleClass="small-heading"/>
            <BarChart fx:id="utilChart" prefHeight="160" prefWidth="280">
                <xAxis>
                    <CategoryAxis/>
                </xAxis>
                <yAxis>
                    <NumberAxis/>
                </yAxis>
            </BarChart>

            <Pane VBox.vgrow="ALWAYS"/>

            <HBox spacing="8" alignment="CENTER">
                <Button text="Download CSV" fx:id="downloadCsvBtn" styleClass="ghost-button"/>
                <Button text="Download PDF" fx:id="downloadPdfBtn" styleClass="ghost-button"/>
            </HBox>
        </VBox>
    </right>

</BorderPane>
